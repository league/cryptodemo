<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title></title>
<style>
input[type=text]{
	font-family:monospace;
}
td{
	text-align:center;
}
.password{
	font-family:monospace;
	display:inline-block;
	margin:8px;
	padding:0px 2px;
	background-color:yellow;
	font-size:125%;
}
body{
	height:100%;
} 
</style>
</head>
<body onmousemove="rndseed(event)" onkeydown="rndseed(event)" onkeyup="rndseed(event)">
<div style="width:100%;height:100%;position:absolute;top:0px;left:0px;z-index:-1;"></div>

<noscript><p style="text-align:center;color:red;">JavaScript is not enabled in your browser, you must enable JavaScript to use the password generator</p></noscript>

<table style="width:100%;"><colgroup><col style="width:380px;"><col style="width:auto;"><col style="width:380px;"></colgroup><tr>
<td style="text-align:left;vertical-align:top;">
Predefined settings<br>
<a href="javascript:wifikey()">Full 256-bit WiFi key</a><br>
<a href="javascript:pincode()">4 digit pin code</a><br>
Standard <a href="javascript:standard(5)">10^9</a>
<a href="javascript:standard(7)">10^13</a>
<a href="javascript:standard(9)">10^17</a>
<a href="javascript:standard(11)">10^21</a><br>
Alpha-numeric <a href="javascript:alpha(6)">10^9</a>
<a href="javascript:alpha(8)">10^13</a>
<a href="javascript:alpha(10)">10^17</a>
<a href="javascript:alpha(12)">10^21</a>
</td>

<td>
<table style="margin:auto;">
<tr><th>Must<br>use</th><th>Use</th><th></th></tr>
<tr><td><input id="0m" type="checkbox" checked="checked"></td><td><input id="0u" type="checkbox" checked="checked"></td><td>0-9<input id="0v" type="hidden" value="0123456789"></td></tr>
<tr><td><input id="1m" type="checkbox" checked="checked"></td><td><input id="1u" type="checkbox" checked="checked"></td><td>a-z<input id="1v" type="hidden" value="abcdefghijklmnopqrstuvwxyz"></td></tr>
<tr><td><input id="2m" type="checkbox" checked="checked"></td><td><input id="2u" type="checkbox" checked="checked"></td><td>A-Z<input id="2v" type="hidden" value="ABCDEFGHIJKLMNOPQRSTUVWXYZ"></td></tr>
<tr><td><input id="3m" type="checkbox" checked="checked"></td><td><input id="3u" type="checkbox" checked="checked"></td><td><input id="3v" size="40" type="text" value="!&quot;@#$%&amp;/{}()[]=+?*&lt;&gt;\,;.:-_ "></td></tr>
<tr><td><input id="4m" type="checkbox"></td><td><input id="4u" type="checkbox"></td><td><input id="4v" size="40" type="text" value="|`~^'"></td></tr>
<tr><td><input id="5m" type="checkbox"></td><td><input id="5u" type="checkbox"></td><td><input id="5v" size="40" type="text" value="0123456789ABCDEF"></td></tr>
</table>
<br>
<div style="margin:auto;width:350px;text-align:center;">Length: <input id="pwlen" size="3" type="text" value="7" style="text-align:right;"> Strength: 10^<span id="strenexp"></span><br><br>
Number of codes <select id="numcodes"><option value="1">1</option><option value="20" selected="selected">20</option><option value="100">100</option></select><br><br>
<input id="generatebutton" type="button" value="Move your mouse to seed the generator" onclick="generate(true)" disabled="disabled"></div>
</td>

<td style="text-align:left;vertical-align:top;">
Strength table - <a href="javascript:exp()">Explaination</a><br>
10^9 Low security password<span id="pass9"></span><br>
10^13 High security password<span id="pass13"></span><br>
10^17 Low security encryption/WiFi/signature key<span id="pass17"></span><br>
10^21 High security encryption/WiFi/signature key<span id="pass21"></span>
</td>
</tr>
</table>

<p id="result"></p>
<p style="text-align:center;display:none;" id="practice">Practice typing your chosen password<br><input id="checkinput" type="password" onkeyup="checkpassword(event,this.value)"><br><span id="practiceresult"></span></p>
<p id="debug"></p>
<script>
primelist=[2,3,5,7,11]
primelistlen=5
lastprime=11
function prime(index){
	while(primelistlen<=index){
		lastprime+=2
		var sqrtlastprime=Math.sqrt(lastprime)
		for(var a=1;true;a++){
			if(!(lastprime%primelist[a]))break;
			if(primelist[a]>sqrtlastprime){
				primelist[primelistlen]=lastprime
				primelistlen++
				break
			}
		}
	}
	return primelist[index]
}

//alert(prime(55))
//alert(primelist)

//e41=Math.pow(2,41)
bp=2199023255579
//alert(123456789012%34567890123)
//alert(123456789012-34567890123*3)
//alert(e41-2199023255550)
//randomlist=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]
//randomlist=[2,2,2,4,2,6,2,8,2,10,12,12,12,14,12,16,12,18,12,20,22,22,22,24,22,26,22,28,22,30,32,32]
randomlist=[]
for(a=0;a<32;a++) randomlist[a]=123456789;
randompoint=0
document.getElementById("generatebutton").disabled=true

//debug
lasttime=0
diffs=[]
function rnd(limit,seed){
	if(!seed) seed=(new Date()).getTime();
	for(var a=0;a<5;a++){
		randompoint++
		randomlist[randompoint%32]=(randomlist[randompoint%32]+(randomlist[(1+randompoint)%32]+1)*(seed%prime(47+(randompoint%89))))%bp
	}
	if(randompoint>499){
		document.getElementById("generatebutton").disabled=false
		document.getElementById("generatebutton").value="Generate"
	}
	//document.getElementById("debug").innerHTML=randomlist.join("<br>")
	if(limit){
		if(((bp%limit)>randomlist[randompoint%32]) && (bp>limit)){
			return rnd(limit)
		}
		else{
			return randomlist[randompoint%32]%limit
		}
	}
	//diffs[diffs.length]=seed-lasttime
	//lasttime=seed
	//document.getElementById("debug").innerHTML=diffs.join(" ")
}
function rndseed(e){
	rnd(false,(new Date()).getTime()+prime(46)*(e.clientX||e.screenX||e.pageX||1)+prime(45)*(e.clientY||e.screenY||e.pageY||1))
}
//onmousemove=rndseed
//onkeydown=rndseed
//onkeyup=rndseed

//alert(undefined || 4)

passwords=[]

function generate(doit){
	if(randompoint<500) return;
	var numinp=6
	var numberofcodes=1*document.getElementById("numcodes").value
	var strlen=1*document.getElementById("pwlen").value
	var arr=[]
	var library=""
	var mustuse=[]
	for(var a=0;a<numinp;a++){
		if(document.getElementById(a+"u").checked){
			if(document.getElementById(a+"v").value.length>0){
				library+=document.getElementById(a+"v").value
				if(document.getElementById(a+"m").checked){
					mustuse[mustuse.length]=document.getElementById(a+"v").value
					//var b=rnd(strlen)
					//while(arr[b]!==false) b=rnd(strlen);
					//arr[b]=library[library.length-1][rnd(library[library.length-1].length)]
				}
			}
		}
	}
	library=library.split("")
	library.sort()
	var libstren=1
	var liblen=library.length
	for(a=0;a<liblen-1;a++){
		libstren+=(library[a]!=library[a+1])
	}
	var strength=Math.floor(10*strlen*Math.log(libstren)*Math.LOG10E)/10
	document.getElementById("strenexp").innerHTML=strength
	for(a=9;a<22;a+=4){
		if(strength>=a){
			document.getElementById("pass"+a).innerHTML=" - Passed"
			document.getElementById("pass"+a).style.color="green"
		}
		else{
			document.getElementById("pass"+a).innerHTML=" - Failed"
			document.getElementById("pass"+a).style.color="red"
		}
	}
	var mustlen=mustuse.length
	var htmlstructure=""
	if(doit){
		passwords=[]
		restartgen:
		for(a=numberofcodes;a--;){
			for(var b=0;b<strlen;b++){
				arr[b]=library[rnd(liblen)]
			}
			for(var c=0;c<mustlen;c++){
				var included=false
				for(var b=0;b<strlen;b++){
					if(mustuse[c].indexOf(arr[b])>=0) included=true;
				}
				if(!included){
					if(strlen>=mustlen) a++;
					continue restartgen
				}
			}
			passwords[passwords.length]=arr.join("")
			htmlstructure+="<span class='password'>"+arr.join("").replace(/\x26/g,"&amp;").replace(/\x3c/g,"&lt;").replace(/\x3e/g,"&gt;").replace(/\x20/g,"&nbsp;")+"<\/span>"
		}
		//dbarr=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
		//for(a=0;a<900000;a++) dbarr[rnd(90)]+=1;
		document.getElementById("result").innerHTML=htmlstructure//+dbarr
		document.getElementById("practice").style.display=""
		document.getElementById("checkinput").value=""
		document.getElementById("practiceresult").innerHTML=""
	}
}

function checkpassword(e,pass){
	if(e.keyCode==13) document.getElementById("checkinput").value="";
	for(var a=0;a<passwords.length;a++){
		if(passwords[a].indexOf(pass)==0){
			if(pass.length===passwords[a].length){
				document.getElementById("practiceresult").innerHTML="Correct"
				document.getElementById("practiceresult").style.color="green"
			}
			else{
				document.getElementById("practiceresult").innerHTML=""
			}
			return
		}
	}
	document.getElementById("practiceresult").innerHTML="Wrong"
	document.getElementById("practiceresult").style.color="red"
}

function wifikey(){
	document.getElementById("0u").checked=false
	document.getElementById("1u").checked=false
	document.getElementById("2u").checked=false
	document.getElementById("3u").checked=false
	document.getElementById("4u").checked=false
	document.getElementById("5u").checked=true
	document.getElementById("5v").value="0123456789ABCDEF"
	document.getElementById("pwlen").value="64"
	document.getElementById("numcodes").value="1"
	if(randompoint>499) generate(true);
}
function pincode(){
	document.getElementById("0u").checked=true
	document.getElementById("1u").checked=false
	document.getElementById("2u").checked=false
	document.getElementById("3u").checked=false
	document.getElementById("4u").checked=false
	document.getElementById("5u").checked=false
	document.getElementById("pwlen").value="4"
	document.getElementById("numcodes").value="1"
	if(randompoint>499) generate(true);
}
function standard(len){
	document.getElementById("0m").checked=true
	document.getElementById("1m").checked=true
	document.getElementById("2m").checked=true
	document.getElementById("3m").checked=true
	document.getElementById("0u").checked=true
	document.getElementById("1u").checked=true
	document.getElementById("2u").checked=true
	document.getElementById("3u").checked=true
	document.getElementById("4u").checked=false
	document.getElementById("5u").checked=false
	document.getElementById("3v").value='!"@#$%&/{}()[]=+?*<>\,;.:-_ '
	document.getElementById("pwlen").value=""+len
	if(document.getElementById("numcodes").value=="1") document.getElementById("numcodes").value="20";
	if(randompoint>499) generate(true);
}
function alpha(len){
	document.getElementById("0m").checked=true
	document.getElementById("1m").checked=true
	document.getElementById("2m").checked=true
	document.getElementById("0u").checked=true
	document.getElementById("1u").checked=true
	document.getElementById("2u").checked=true
	document.getElementById("3u").checked=false
	document.getElementById("4u").checked=false
	document.getElementById("5u").checked=false
	document.getElementById("pwlen").value=""+len
	if(document.getElementById("numcodes").value=="1") document.getElementById("numcodes").value="20";
	if(randompoint>499) generate(true);
}
</script>
</body>
</html>